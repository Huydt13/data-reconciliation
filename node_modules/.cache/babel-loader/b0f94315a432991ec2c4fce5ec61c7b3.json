{"ast":null,"code":"var _jsxFileName = \"H:\\\\BAKCO\\\\pj\\\\cds\\\\src\\\\infection-chain\\\\components\\\\subject\\\\information\\\\form-sections\\\\SearchSubjectSection.js\";\nimport React, { useCallback, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Header, Select } from 'semantic-ui-react';\nimport httpClient from 'app/utils/http-client';\nimport apiLinks from 'app/utils/api-links';\nimport moment from 'moment';\nimport { useDispatch } from 'react-redux';\nimport { selectSubjectOnCreatingProfile } from 'infection-chain/actions/subject';\nimport { deburr } from 'app/utils/helpers';\nconst SearchSubjectSection = _ref => {\n  let {\n    type,\n    initialProfileId,\n    onChange: onChangeProp\n  } = _ref;\n  const [searchLoading, setSearchLoading] = useState(false);\n  const [subjectSuggestions, setSubjectSuggestions] = useState([]);\n  const dispatch = useDispatch();\n  const handleSearch = useCallback((_, _ref2) => {\n    let {\n      searchQuery: name\n    } = _ref2;\n    if (name.length > 2) {\n      setSearchLoading(true);\n      httpClient.callApi({\n        url: type === 0 ? apiLinks.infectionChain.subjects.getF0 : type === 1 ? apiLinks.infectionChain.subjects.getF11 : apiLinks.infectionChain.subjects.getPersonels,\n        params: {\n          name,\n          diseaseTypeId: 'b597cc8f-74b6-434d-8b9d-52b74595a1de',\n          infectionTypeIds: type === 2 ? 'efb02881-ebec-49c9-875b-5ec15f44d58d' : undefined,\n          pageSize: 20,\n          pageIndex: 0\n        }\n      }).then(_ref3 => {\n        let {\n          data: {\n            data\n          }\n        } = _ref3;\n        setSubjectSuggestions(data || []);\n      }).finally(() => {\n        setSearchLoading(false);\n      });\n    }\n  }, [type]);\n  const options = subjectSuggestions.map(s => {\n    var _s$privateAlias, _s$alias, _s$privateAlias2, _s$alias2;\n    return {\n      text: s.fullName,\n      value: s.profileId,\n      content: /*#__PURE__*/React.createElement(Header, {\n        content: s.fullName,\n        subheader: type === 0 ? `Năm sinh: ${s.dateOfBirth ? `${moment(s === null || s === void 0 ? void 0 : s.dateOfBirth).format('YYYY')}` : ''}, Bí danh HCM: ${(_s$privateAlias = s === null || s === void 0 ? void 0 : s.privateAlias) !== null && _s$privateAlias !== void 0 ? _s$privateAlias : ''}, Bí danh BYT: ${(_s$alias = s === null || s === void 0 ? void 0 : s.alias) !== null && _s$alias !== void 0 ? _s$alias : ''}` : `Năm sinh: ${s.dateOfBirth ? `${moment(s === null || s === void 0 ? void 0 : s.dateOfBirth).format('YYYY')}` : ''}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 7\n        }\n      }),\n      mapped: `${s.fullName} ${s.dateOfBirth ? `${moment(s === null || s === void 0 ? void 0 : s.dateOfBirth).format('YYYY')}` : ''} ${(_s$privateAlias2 = s === null || s === void 0 ? void 0 : s.privateAlias) !== null && _s$privateAlias2 !== void 0 ? _s$privateAlias2 : ''} ${(_s$alias2 = s === null || s === void 0 ? void 0 : s.alias) !== null && _s$alias2 !== void 0 ? _s$alias2 : ''}`\n    };\n  });\n  return /*#__PURE__*/React.createElement(Select, {\n    search: (searchOptions, value) => searchOptions.filter(_ref4 => {\n      let {\n        mapped\n      } = _ref4;\n      return deburr(mapped).includes(deburr(value));\n    }),\n    deburr: true,\n    fluid: true,\n    clearable: true,\n    options: options,\n    loading: searchLoading,\n    defaultValue: initialProfileId,\n    placeholder: \"T\\xECm ki\\u1EBFm (3 k\\xFD t\\u1EF1)\",\n    onChange: (_, _ref5) => {\n      let {\n        value\n      } = _ref5;\n      if (onChangeProp) {\n        onChangeProp(value);\n      } else {\n        dispatch(selectSubjectOnCreatingProfile(value, type === 0));\n      }\n    },\n    onSearchChange: handleSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 5\n    }\n  });\n};\nSearchSubjectSection.propTypes = {\n  type: PropTypes.number.isRequired,\n  initialProfileId: PropTypes.number,\n  onChange: PropTypes.func\n};\nSearchSubjectSection.defaultProps = {\n  initialProfileId: 0,\n  onChange: () => {}\n};\nexport default SearchSubjectSection;","map":{"version":3,"names":["React","useCallback","useState","PropTypes","Header","Select","httpClient","apiLinks","moment","useDispatch","selectSubjectOnCreatingProfile","deburr","SearchSubjectSection","_ref","type","initialProfileId","onChange","onChangeProp","searchLoading","setSearchLoading","subjectSuggestions","setSubjectSuggestions","dispatch","handleSearch","_","_ref2","searchQuery","name","length","callApi","url","infectionChain","subjects","getF0","getF11","getPersonels","params","diseaseTypeId","infectionTypeIds","undefined","pageSize","pageIndex","then","_ref3","data","finally","options","map","s","_s$privateAlias","_s$alias","_s$privateAlias2","_s$alias2","text","fullName","value","profileId","content","createElement","subheader","dateOfBirth","format","privateAlias","alias","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","mapped","search","searchOptions","filter","_ref4","includes","fluid","clearable","loading","defaultValue","placeholder","_ref5","onSearchChange","propTypes","number","isRequired","func","defaultProps"],"sources":["H:/BAKCO/pj/cds/src/infection-chain/components/subject/information/form-sections/SearchSubjectSection.js"],"sourcesContent":["import React, { useCallback, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Header, Select } from 'semantic-ui-react';\n\nimport httpClient from 'app/utils/http-client';\nimport apiLinks from 'app/utils/api-links';\nimport moment from 'moment';\n\nimport { useDispatch } from 'react-redux';\nimport { selectSubjectOnCreatingProfile } from 'infection-chain/actions/subject';\n\nimport { deburr } from 'app/utils/helpers';\n\nconst SearchSubjectSection = ({\n  type,\n  initialProfileId,\n  onChange: onChangeProp,\n}) => {\n  const [searchLoading, setSearchLoading] = useState(false);\n  const [subjectSuggestions, setSubjectSuggestions] = useState([]);\n\n  const dispatch = useDispatch();\n  const handleSearch = useCallback(\n    (_, { searchQuery: name }) => {\n      if (name.length > 2) {\n        setSearchLoading(true);\n        httpClient\n          .callApi({\n            url:\n              type === 0\n                ? apiLinks.infectionChain.subjects.getF0\n                : type === 1\n                ? apiLinks.infectionChain.subjects.getF11\n                : apiLinks.infectionChain.subjects.getPersonels,\n            params: {\n              name,\n              diseaseTypeId: 'b597cc8f-74b6-434d-8b9d-52b74595a1de',\n              infectionTypeIds:\n                type === 2 ? 'efb02881-ebec-49c9-875b-5ec15f44d58d' : undefined,\n              pageSize: 20,\n              pageIndex: 0,\n            },\n          })\n          .then(({ data: { data } }) => {\n            setSubjectSuggestions(data || []);\n          })\n          .finally(() => {\n            setSearchLoading(false);\n          });\n      }\n    },\n    [type],\n  );\n\n  const options = subjectSuggestions.map((s) => ({\n    text: s.fullName,\n    value: s.profileId,\n    content: (\n      <Header\n        content={s.fullName}\n        subheader={\n          type === 0\n            ? `Năm sinh: ${\n                s.dateOfBirth ? `${moment(s?.dateOfBirth).format('YYYY')}` : ''\n              }, Bí danh HCM: ${s?.privateAlias ?? ''}, Bí danh BYT: ${\n                s?.alias ?? ''\n              }`\n            : `Năm sinh: ${\n                s.dateOfBirth ? `${moment(s?.dateOfBirth).format('YYYY')}` : ''\n              }`\n        }\n      />\n    ),\n    mapped: `${s.fullName} ${\n      s.dateOfBirth ? `${moment(s?.dateOfBirth).format('YYYY')}` : ''\n    } ${s?.privateAlias ?? ''} ${s?.alias ?? ''}`,\n  }));\n\n  return (\n    <Select\n      search={(searchOptions, value) =>\n        searchOptions.filter(({ mapped }) =>\n          deburr(mapped).includes(deburr(value)),\n        )\n      }\n      deburr\n      fluid\n      clearable\n      options={options}\n      loading={searchLoading}\n      defaultValue={initialProfileId}\n      placeholder=\"Tìm kiếm (3 ký tự)\"\n      onChange={(_, { value }) => {\n        if (onChangeProp) {\n          onChangeProp(value);\n        } else {\n          dispatch(selectSubjectOnCreatingProfile(value, type === 0));\n        }\n      }}\n      onSearchChange={handleSearch}\n    />\n  );\n};\n\nSearchSubjectSection.propTypes = {\n  type: PropTypes.number.isRequired,\n  initialProfileId: PropTypes.number,\n  onChange: PropTypes.func,\n};\n\nSearchSubjectSection.defaultProps = {\n  initialProfileId: 0,\n  onChange: () => {},\n};\n\nexport default SearchSubjectSection;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}