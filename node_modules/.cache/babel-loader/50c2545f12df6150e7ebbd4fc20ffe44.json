{"ast":null,"code":"var _jsxFileName = \"H:\\\\BAKCO\\\\pj\\\\data reconciliation\\\\src\\\\contact\\\\components\\\\locations\\\\visitor\\\\LocationVisitorTable.js\";\nimport React, { useEffect, useState } from 'react';\nimport { FiPlus } from 'react-icons/fi';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getLocationVisitors } from 'contact/actions/location';\nimport { formatToTime } from 'app/utils/helpers';\nimport { LocationType } from 'infection-chain/utils/constants';\nimport { DataTable } from 'app/components/shared';\nimport VisitorDetailModal from './VisitorDetailModal';\nimport AddVisitorModal from './AddVisitorModal';\nconst columns = [{\n  Header: '#',\n  accessor: 'index'\n}, {\n  Header: 'Thời gian',\n  formatter: _ref => {\n    let {\n      fromTime,\n      toTime\n    } = _ref;\n    return `${formatToTime(fromTime)} ~ ${formatToTime(toTime)}`;\n  }\n}, {\n  Header: 'Số tiếp xúc',\n  formatter: _ref2 => {\n    let {\n      visitorProfileIds\n    } = _ref2;\n    return visitorProfileIds.length;\n  }\n}];\nconst LocationVisitorTable = () => {\n  const dispatch = useDispatch();\n  const selectedEstate = useSelector(s => s.location.selectedEstate);\n  const selectedAirplane = useSelector(s => s.location.selectedAirplane);\n  const selectedVehicle = useSelector(s => s.location.selectedVehicle);\n  const selected = selectedEstate || selectedAirplane || selectedVehicle;\n  const locationVisitorsData = useSelector(s => s.location.locationVisitorsData);\n  const getLocationVisitorsLoading = useSelector(s => s.location.getLocationVisitorsLoading);\n  const {\n    data,\n    totalPages\n  } = locationVisitorsData;\n  const [pageIndex, setPageIndex] = useState(0);\n  const [pageSize, setPageSize] = useState(10);\n  const [selectingRow, setSelectingRow] = useState(undefined);\n  const [openAddVisitorModal, setOpenAddVisitorModal] = useState(false);\n  useEffect(() => {\n    const getData = async () => {\n      if (selected && !selectingRow && !openAddVisitorModal) {\n        switch (selected.id) {\n          case selectedEstate === null || selectedEstate === void 0 ? void 0 : selectedEstate.id:\n            await dispatch(getLocationVisitors({\n              locationId: selected.id,\n              locationType: LocationType.LOCATION,\n              pageIndex,\n              pageSize\n            }));\n            break;\n          case selectedAirplane === null || selectedAirplane === void 0 ? void 0 : selectedAirplane.id:\n            await dispatch(getLocationVisitors({\n              locationId: selected.id,\n              locationType: LocationType.AIRPLANE,\n              pageIndex,\n              pageSize\n            }));\n            break;\n          case selectedVehicle === null || selectedVehicle === void 0 ? void 0 : selectedVehicle.id:\n            await dispatch(getLocationVisitors({\n              locationId: selected.id,\n              locationType: LocationType.VEHICLE,\n              pageIndex,\n              pageSize\n            }));\n            break;\n          default:\n            break;\n        }\n      }\n    };\n    getData();\n  }, [dispatch, selected, selectedEstate, selectedAirplane, selectedVehicle, pageIndex, pageSize, selectingRow, openAddVisitorModal]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(DataTable, {\n    columns: columns,\n    loading: getLocationVisitorsLoading,\n    data: data.map((r, i) => ({\n      ...r,\n      index: i + 1\n    })),\n    pageCount: totalPages,\n    onPaginationChange: _ref3 => {\n      let {\n        pageSize: ps,\n        pageIndex: pi\n      } = _ref3;\n      setPageSize(ps);\n      setPageIndex(pi);\n    },\n    onRowClick: setSelectingRow,\n    actions: [{\n      icon: /*#__PURE__*/React.createElement(FiPlus, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 19\n        }\n      }),\n      color: 'green',\n      title: 'Thêm mốc dịch tễ',\n      onClick: () => setOpenAddVisitorModal(true),\n      globalAction: true\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(VisitorDetailModal, {\n    onClose: () => setSelectingRow(undefined),\n    data: selectingRow,\n    location: {\n      ...selected,\n      locationType: LocationType.LOCATION\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(AddVisitorModal, {\n    open: openAddVisitorModal,\n    data: {\n      ...selected,\n      locationType: LocationType.LOCATION\n    },\n    onClose: () => {\n      setOpenAddVisitorModal(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }\n  }));\n};\nexport default LocationVisitorTable;","map":{"version":3,"names":["React","useEffect","useState","FiPlus","useDispatch","useSelector","getLocationVisitors","formatToTime","LocationType","DataTable","VisitorDetailModal","AddVisitorModal","columns","Header","accessor","formatter","_ref","fromTime","toTime","_ref2","visitorProfileIds","length","LocationVisitorTable","dispatch","selectedEstate","s","location","selectedAirplane","selectedVehicle","selected","locationVisitorsData","getLocationVisitorsLoading","data","totalPages","pageIndex","setPageIndex","pageSize","setPageSize","selectingRow","setSelectingRow","undefined","openAddVisitorModal","setOpenAddVisitorModal","getData","id","locationId","locationType","LOCATION","AIRPLANE","VEHICLE","createElement","Fragment","loading","map","r","i","index","pageCount","onPaginationChange","_ref3","ps","pi","onRowClick","actions","icon","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","color","title","onClick","globalAction","onClose","open"],"sources":["H:/BAKCO/pj/data reconciliation/src/contact/components/locations/visitor/LocationVisitorTable.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport { FiPlus } from 'react-icons/fi';\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getLocationVisitors } from 'contact/actions/location';\n\nimport { formatToTime } from 'app/utils/helpers';\nimport { LocationType } from 'infection-chain/utils/constants';\n\nimport { DataTable } from 'app/components/shared';\nimport VisitorDetailModal from './VisitorDetailModal';\nimport AddVisitorModal from './AddVisitorModal';\n\nconst columns = [\n  { Header: '#', accessor: 'index' },\n  {\n    Header: 'Thời gian',\n    formatter: ({ fromTime, toTime }) =>\n      `${formatToTime(fromTime)} ~ ${formatToTime(toTime)}`,\n  },\n  {\n    Header: 'Số tiếp xúc',\n    formatter: ({ visitorProfileIds }) => visitorProfileIds.length,\n  },\n];\nconst LocationVisitorTable = () => {\n  const dispatch = useDispatch();\n\n  const selectedEstate = useSelector((s) => s.location.selectedEstate);\n  const selectedAirplane = useSelector((s) => s.location.selectedAirplane);\n  const selectedVehicle = useSelector((s) => s.location.selectedVehicle);\n  const selected = selectedEstate || selectedAirplane || selectedVehicle;\n\n  const locationVisitorsData = useSelector(\n    (s) => s.location.locationVisitorsData,\n  );\n  const getLocationVisitorsLoading = useSelector(\n    (s) => s.location.getLocationVisitorsLoading,\n  );\n  const { data, totalPages } = locationVisitorsData;\n\n  const [pageIndex, setPageIndex] = useState(0);\n  const [pageSize, setPageSize] = useState(10);\n  const [selectingRow, setSelectingRow] = useState(undefined);\n  const [openAddVisitorModal, setOpenAddVisitorModal] = useState(false);\n\n  useEffect(() => {\n    const getData = async () => {\n      if (selected && !selectingRow && !openAddVisitorModal) {\n        switch (selected.id) {\n          case selectedEstate?.id:\n            await dispatch(\n              getLocationVisitors({\n                locationId: selected.id,\n                locationType: LocationType.LOCATION,\n                pageIndex,\n                pageSize,\n              }),\n            );\n            break;\n          case selectedAirplane?.id:\n            await dispatch(\n              getLocationVisitors({\n                locationId: selected.id,\n                locationType: LocationType.AIRPLANE,\n                pageIndex,\n                pageSize,\n              }),\n            );\n            break;\n          case selectedVehicle?.id:\n            await dispatch(\n              getLocationVisitors({\n                locationId: selected.id,\n                locationType: LocationType.VEHICLE,\n                pageIndex,\n                pageSize,\n              }),\n            );\n            break;\n          default:\n            break;\n        }\n      }\n    };\n    getData();\n  }, [\n    dispatch,\n    selected,\n    selectedEstate,\n    selectedAirplane,\n    selectedVehicle,\n    pageIndex,\n    pageSize,\n    selectingRow,\n    openAddVisitorModal,\n  ]);\n\n  return (\n    <>\n      <DataTable\n        columns={columns}\n        loading={getLocationVisitorsLoading}\n        data={data.map((r, i) => ({ ...r, index: i + 1 }))}\n        pageCount={totalPages}\n        onPaginationChange={({ pageSize: ps, pageIndex: pi }) => {\n          setPageSize(ps);\n          setPageIndex(pi);\n        }}\n        onRowClick={setSelectingRow}\n        actions={[\n          {\n            icon: <FiPlus />,\n            color: 'green',\n            title: 'Thêm mốc dịch tễ',\n            onClick: () => setOpenAddVisitorModal(true),\n            globalAction: true,\n          },\n        ]}\n      />\n      <VisitorDetailModal\n        onClose={() => setSelectingRow(undefined)}\n        data={selectingRow}\n        location={{ ...selected, locationType: LocationType.LOCATION }}\n      />\n      <AddVisitorModal\n        open={openAddVisitorModal}\n        data={{ ...selected, locationType: LocationType.LOCATION }}\n        onClose={() => {\n          setOpenAddVisitorModal(false);\n        }}\n      />\n    </>\n  );\n};\n\nexport default LocationVisitorTable;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}