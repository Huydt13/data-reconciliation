{"ast":null,"code":"var _jsxFileName = \"H:\\\\BAKCO\\\\pj\\\\data reconciliation\\\\src\\\\quarantine-facilities\\\\components\\\\quarantine-at-home\\\\BeingInHomeTable.js\";\n/* eslint-disable no-nested-ternary */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { FiCommand, FiFileText } from 'react-icons/fi';\nimport moment from 'moment';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useAuth } from 'app/hooks';\nimport { getInHome } from 'quarantine-facilities/actions/quarantine-facility';\nimport { createAssignWithDate, getPrefixes, getUnitInfo } from 'medical-test/actions/medical-test';\nimport { DataTable } from 'app/components/shared';\nimport { checkFilter, formatAddressToString } from 'app/utils/helpers';\nimport ProcessModal from 'infection-chain/components/subject/medical-test/ProcessModal';\nimport FacilityFilter from '../quarantine-in-facility/FacilityFilter';\nconst FacilityInHomeTable = () => {\n  const dispatch = useDispatch();\n  const {\n    isAdmin\n  } = useAuth();\n  const {\n    inHomeData,\n    getInHomeLoading\n  } = useSelector(s => s.quarantineFacility);\n  const {\n    data,\n    totalPages\n  } = inHomeData;\n  const [filter, setFilter] = useState({});\n  const [pageIndex, setPageIndex] = useState(0);\n  const [pageSize, setPageSize] = useState(10);\n  useEffect(() => {\n    dispatch(getPrefixes());\n    dispatch(getUnitInfo());\n  }, [dispatch]);\n  const [profileId, setProfileId] = useState('');\n  const [processModal, setProcessModal] = useState(false);\n  const handleProcess = async d => {\n    await dispatch(createAssignWithDate({\n      ...d,\n      profileId\n    }));\n    setProfileId('');\n    setProcessModal(false);\n  };\n  const getData = useCallback(() => {\n    dispatch(getInHome({\n      ...filter,\n      pageSize,\n      pageIndex\n    }));\n  }, [dispatch, filter, pageSize, pageIndex]);\n  useEffect(getData, [getData]);\n  const columns = useMemo(() => {\n    const columnsTable = [{\n      Header: '#',\n      accessor: 'index'\n    }, {\n      Header: 'Tên',\n      formatter: r => r.quarantineForm.requester.fullName\n    }, {\n      Header: 'Ngày/Năm sinh',\n      formatter: r => r.quarantineForm.requester.dateOfBirth ? moment(r.quarantineForm.requester.dateOfBirth).format(r.quarantineForm.requester.hasYearOfBirthOnly ? 'YYYY' : 'DD-MM-YYYY') : ''\n    }, {\n      Header: 'Ngày bắt đầu cách ly tại nhà',\n      formatter: r => `${moment(r.quarantineForm.homeRequest.startTime).format('DD-MM-YYYY')}`\n    }, {\n      Header: 'Địa chỉ nhà',\n      formatter: r => formatAddressToString(r.quarantineForm.homeRequest.homeAddress)\n    }];\n    if (isAdmin) {\n      const addingColumns = [{\n        Header: 'Khu cách ly',\n        formatter: r => {\n          var _r$facility$name;\n          return (_r$facility$name = r === null || r === void 0 ? void 0 : r.facility.name) !== null && _r$facility$name !== void 0 ? _r$facility$name : '';\n        }\n      }];\n      columnsTable.splice(3, 0, ...addingColumns);\n    }\n    return columnsTable;\n  }, [isAdmin]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }\n  }, isAdmin && /*#__PURE__*/React.createElement(FacilityFilter, {\n    onChange: d => checkFilter(filter, d) && setFilter(d),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(DataTable, {\n    columns: columns,\n    title: \"Danh s\\xE1ch c\\xE1ch ly t\\u1EA1i nh\\xE0\",\n    data: (data || []).map((r, i) => ({\n      ...r,\n      index: i + 1\n    })),\n    pageCount: totalPages,\n    onPaginationChange: p => {\n      setPageIndex(p.pageIndex);\n      setPageSize(p.pageSize);\n    },\n    loading: getInHomeLoading,\n    actions: [{\n      icon: /*#__PURE__*/React.createElement(FiCommand, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 19\n        }\n      }),\n      title: 'Chỉ định xét nghiệm',\n      color: 'yellow',\n      onClick: r => {\n        setProfileId(r.quarantineForm.requester.profileId);\n        setProcessModal(true);\n      }\n    }, {\n      icon: /*#__PURE__*/React.createElement(FiFileText, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 19\n        }\n      }),\n      title: 'Hồ sơ',\n      color: 'blue',\n      onClick: r => {\n        window.open(`/profile/${r.quarantineForm.requester.profileId}/quarantine`, '_blank');\n      }\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(ProcessModal, {\n    key: processModal ? 'OpenProcessModal' : 'CloseProcessModal',\n    open: processModal,\n    onClose: () => setProcessModal(false),\n    onSubmit: handleProcess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }\n  }));\n};\nexport default FacilityInHomeTable;","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useState","FiCommand","FiFileText","moment","useDispatch","useSelector","useAuth","getInHome","createAssignWithDate","getPrefixes","getUnitInfo","DataTable","checkFilter","formatAddressToString","ProcessModal","FacilityFilter","FacilityInHomeTable","dispatch","isAdmin","inHomeData","getInHomeLoading","s","quarantineFacility","data","totalPages","filter","setFilter","pageIndex","setPageIndex","pageSize","setPageSize","profileId","setProfileId","processModal","setProcessModal","handleProcess","d","getData","columns","columnsTable","Header","accessor","formatter","r","quarantineForm","requester","fullName","dateOfBirth","format","hasYearOfBirthOnly","homeRequest","startTime","homeAddress","addingColumns","_r$facility$name","facility","name","splice","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onChange","title","map","i","index","pageCount","onPaginationChange","p","loading","actions","icon","color","onClick","window","open","key","onClose","onSubmit"],"sources":["H:/BAKCO/pj/data reconciliation/src/quarantine-facilities/components/quarantine-at-home/BeingInHomeTable.js"],"sourcesContent":["/* eslint-disable no-nested-ternary */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { FiCommand, FiFileText } from 'react-icons/fi';\n\nimport moment from 'moment';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useAuth } from 'app/hooks';\nimport { getInHome } from 'quarantine-facilities/actions/quarantine-facility';\nimport {\n  createAssignWithDate,\n  getPrefixes,\n  getUnitInfo,\n} from 'medical-test/actions/medical-test';\nimport { DataTable } from 'app/components/shared';\nimport { checkFilter, formatAddressToString } from 'app/utils/helpers';\n\nimport ProcessModal from 'infection-chain/components/subject/medical-test/ProcessModal';\nimport FacilityFilter from '../quarantine-in-facility/FacilityFilter';\n\nconst FacilityInHomeTable = () => {\n  const dispatch = useDispatch();\n  const { isAdmin } = useAuth();\n\n  const { inHomeData, getInHomeLoading } = useSelector(\n    (s) => s.quarantineFacility,\n  );\n  const { data, totalPages } = inHomeData;\n\n  const [filter, setFilter] = useState({});\n  const [pageIndex, setPageIndex] = useState(0);\n  const [pageSize, setPageSize] = useState(10);\n\n  useEffect(() => {\n    dispatch(getPrefixes());\n    dispatch(getUnitInfo());\n  }, [dispatch]);\n\n  const [profileId, setProfileId] = useState('');\n  const [processModal, setProcessModal] = useState(false);\n  const handleProcess = async (d) => {\n    await dispatch(\n      createAssignWithDate({\n        ...d,\n        profileId,\n      }),\n    );\n    setProfileId('');\n    setProcessModal(false);\n  };\n\n  const getData = useCallback(() => {\n    dispatch(\n      getInHome({\n        ...filter,\n        pageSize,\n        pageIndex,\n      }),\n    );\n  }, [dispatch, filter, pageSize, pageIndex]);\n  useEffect(getData, [getData]);\n\n  const columns = useMemo(() => {\n    const columnsTable = [\n      { Header: '#', accessor: 'index' },\n      { Header: 'Tên', formatter: (r) => r.quarantineForm.requester.fullName },\n      {\n        Header: 'Ngày/Năm sinh',\n        formatter: (r) =>\n          r.quarantineForm.requester.dateOfBirth\n            ? moment(r.quarantineForm.requester.dateOfBirth).format(\n                r.quarantineForm.requester.hasYearOfBirthOnly\n                  ? 'YYYY'\n                  : 'DD-MM-YYYY',\n              )\n            : '',\n      },\n      {\n        Header: 'Ngày bắt đầu cách ly tại nhà',\n        formatter: (r) =>\n          `${moment(r.quarantineForm.homeRequest.startTime).format(\n            'DD-MM-YYYY',\n          )}`,\n      },\n      {\n        Header: 'Địa chỉ nhà',\n        formatter: (r) =>\n          formatAddressToString(r.quarantineForm.homeRequest.homeAddress),\n      },\n    ];\n    if (isAdmin) {\n      const addingColumns = [\n        {\n          Header: 'Khu cách ly',\n          formatter: (r) => r?.facility.name ?? '',\n        },\n      ];\n      columnsTable.splice(3, 0, ...addingColumns);\n    }\n    return columnsTable;\n  }, [isAdmin]);\n\n  return (\n    <div>\n      {isAdmin && (\n        <FacilityFilter\n          onChange={(d) => checkFilter(filter, d) && setFilter(d)}\n        />\n      )}\n      <DataTable\n        columns={columns}\n        title=\"Danh sách cách ly tại nhà\"\n        data={(data || []).map((r, i) => ({ ...r, index: i + 1 }))}\n        pageCount={totalPages}\n        onPaginationChange={(p) => {\n          setPageIndex(p.pageIndex);\n          setPageSize(p.pageSize);\n        }}\n        loading={getInHomeLoading}\n        actions={[\n          {\n            icon: <FiCommand />,\n            title: 'Chỉ định xét nghiệm',\n            color: 'yellow',\n            onClick: (r) => {\n              setProfileId(r.quarantineForm.requester.profileId);\n              setProcessModal(true);\n            },\n          },\n          {\n            icon: <FiFileText />,\n            title: 'Hồ sơ',\n            color: 'blue',\n            onClick: (r) => {\n              window.open(\n                `/profile/${r.quarantineForm.requester.profileId}/quarantine`,\n                '_blank',\n              );\n            },\n          },\n        ]}\n      />\n\n      <ProcessModal\n        key={processModal ? 'OpenProcessModal' : 'CloseProcessModal'}\n        open={processModal}\n        onClose={() => setProcessModal(false)}\n        onSubmit={handleProcess}\n      />\n    </div>\n  );\n};\n\nexport default FacilityInHomeTable;\n"],"mappings":";AAAA;AACA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AACxE,SAASC,SAAS,EAAEC,UAAU,QAAQ,gBAAgB;AAEtD,OAAOC,MAAM,MAAM,QAAQ;AAC3B,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,SAASC,OAAO,QAAQ,WAAW;AACnC,SAASC,SAAS,QAAQ,mDAAmD;AAC7E,SACEC,oBAAoB,EACpBC,WAAW,EACXC,WAAW,QACN,mCAAmC;AAC1C,SAASC,SAAS,QAAQ,uBAAuB;AACjD,SAASC,WAAW,EAAEC,qBAAqB,QAAQ,mBAAmB;AAEtE,OAAOC,YAAY,MAAM,8DAA8D;AACvF,OAAOC,cAAc,MAAM,0CAA0C;AAErE,MAAMC,mBAAmB,GAAGA,CAAA,KAAM;EAChC,MAAMC,QAAQ,GAAGb,WAAW,EAAE;EAC9B,MAAM;IAAEc;EAAQ,CAAC,GAAGZ,OAAO,EAAE;EAE7B,MAAM;IAAEa,UAAU;IAAEC;EAAiB,CAAC,GAAGf,WAAW,CACjDgB,CAAC,IAAKA,CAAC,CAACC,kBAAkB,CAC5B;EACD,MAAM;IAAEC,IAAI;IAAEC;EAAW,CAAC,GAAGL,UAAU;EAEvC,MAAM,CAACM,MAAM,EAAEC,SAAS,CAAC,GAAG1B,QAAQ,CAAC,CAAC,CAAC,CAAC;EACxC,MAAM,CAAC2B,SAAS,EAAEC,YAAY,CAAC,GAAG5B,QAAQ,CAAC,CAAC,CAAC;EAC7C,MAAM,CAAC6B,QAAQ,EAAEC,WAAW,CAAC,GAAG9B,QAAQ,CAAC,EAAE,CAAC;EAE5CF,SAAS,CAAC,MAAM;IACdmB,QAAQ,CAACR,WAAW,EAAE,CAAC;IACvBQ,QAAQ,CAACP,WAAW,EAAE,CAAC;EACzB,CAAC,EAAE,CAACO,QAAQ,CAAC,CAAC;EAEd,MAAM,CAACc,SAAS,EAAEC,YAAY,CAAC,GAAGhC,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACiC,YAAY,EAAEC,eAAe,CAAC,GAAGlC,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAMmC,aAAa,GAAG,MAAOC,CAAC,IAAK;IACjC,MAAMnB,QAAQ,CACZT,oBAAoB,CAAC;MACnB,GAAG4B,CAAC;MACJL;IACF,CAAC,CAAC,CACH;IACDC,YAAY,CAAC,EAAE,CAAC;IAChBE,eAAe,CAAC,KAAK,CAAC;EACxB,CAAC;EAED,MAAMG,OAAO,GAAGxC,WAAW,CAAC,MAAM;IAChCoB,QAAQ,CACNV,SAAS,CAAC;MACR,GAAGkB,MAAM;MACTI,QAAQ;MACRF;IACF,CAAC,CAAC,CACH;EACH,CAAC,EAAE,CAACV,QAAQ,EAAEQ,MAAM,EAAEI,QAAQ,EAAEF,SAAS,CAAC,CAAC;EAC3C7B,SAAS,CAACuC,OAAO,EAAE,CAACA,OAAO,CAAC,CAAC;EAE7B,MAAMC,OAAO,GAAGvC,OAAO,CAAC,MAAM;IAC5B,MAAMwC,YAAY,GAAG,CACnB;MAAEC,MAAM,EAAE,GAAG;MAAEC,QAAQ,EAAE;IAAQ,CAAC,EAClC;MAAED,MAAM,EAAE,KAAK;MAAEE,SAAS,EAAGC,CAAC,IAAKA,CAAC,CAACC,cAAc,CAACC,SAAS,CAACC;IAAS,CAAC,EACxE;MACEN,MAAM,EAAE,eAAe;MACvBE,SAAS,EAAGC,CAAC,IACXA,CAAC,CAACC,cAAc,CAACC,SAAS,CAACE,WAAW,GAClC5C,MAAM,CAACwC,CAAC,CAACC,cAAc,CAACC,SAAS,CAACE,WAAW,CAAC,CAACC,MAAM,CACnDL,CAAC,CAACC,cAAc,CAACC,SAAS,CAACI,kBAAkB,GACzC,MAAM,GACN,YAAY,CACjB,GACD;IACR,CAAC,EACD;MACET,MAAM,EAAE,8BAA8B;MACtCE,SAAS,EAAGC,CAAC,IACV,GAAExC,MAAM,CAACwC,CAAC,CAACC,cAAc,CAACM,WAAW,CAACC,SAAS,CAAC,CAACH,MAAM,CACtD,YAAY,CACZ;IACN,CAAC,EACD;MACER,MAAM,EAAE,aAAa;MACrBE,SAAS,EAAGC,CAAC,IACX9B,qBAAqB,CAAC8B,CAAC,CAACC,cAAc,CAACM,WAAW,CAACE,WAAW;IAClE,CAAC,CACF;IACD,IAAIlC,OAAO,EAAE;MACX,MAAMmC,aAAa,GAAG,CACpB;QACEb,MAAM,EAAE,aAAa;QACrBE,SAAS,EAAGC,CAAC;UAAA,IAAAW,gBAAA;UAAA,QAAAA,gBAAA,GAAKX,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEY,QAAQ,CAACC,IAAI,cAAAF,gBAAA,cAAAA,gBAAA,GAAI,EAAE;QAAA;MAC1C,CAAC,CACF;MACDf,YAAY,CAACkB,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,GAAGJ,aAAa,CAAC;IAC7C;IACA,OAAOd,YAAY;EACrB,CAAC,EAAE,CAACrB,OAAO,CAAC,CAAC;EAEb,oBACEtB,KAAA,CAAA8D,aAAA;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GACG9C,OAAO,iBACNtB,KAAA,CAAA8D,aAAA,CAAC3C,cAAc;IACbkD,QAAQ,EAAG7B,CAAC,IAAKxB,WAAW,CAACa,MAAM,EAAEW,CAAC,CAAC,IAAIV,SAAS,CAACU,CAAC,CAAE;IAAAuB,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,EAE3D,eACDpE,KAAA,CAAA8D,aAAA,CAAC/C,SAAS;IACR2B,OAAO,EAAEA,OAAQ;IACjB4B,KAAK,EAAC,yCAA2B;IACjC3C,IAAI,EAAE,CAACA,IAAI,IAAI,EAAE,EAAE4C,GAAG,CAAC,CAACxB,CAAC,EAAEyB,CAAC,MAAM;MAAE,GAAGzB,CAAC;MAAE0B,KAAK,EAAED,CAAC,GAAG;IAAE,CAAC,CAAC,CAAE;IAC3DE,SAAS,EAAE9C,UAAW;IACtB+C,kBAAkB,EAAGC,CAAC,IAAK;MACzB5C,YAAY,CAAC4C,CAAC,CAAC7C,SAAS,CAAC;MACzBG,WAAW,CAAC0C,CAAC,CAAC3C,QAAQ,CAAC;IACzB,CAAE;IACF4C,OAAO,EAAErD,gBAAiB;IAC1BsD,OAAO,EAAE,CACP;MACEC,IAAI,eAAE/E,KAAA,CAAA8D,aAAA,CAACzD,SAAS;QAAA0D,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,EAAG;MACnBE,KAAK,EAAE,qBAAqB;MAC5BU,KAAK,EAAE,QAAQ;MACfC,OAAO,EAAGlC,CAAC,IAAK;QACdX,YAAY,CAACW,CAAC,CAACC,cAAc,CAACC,SAAS,CAACd,SAAS,CAAC;QAClDG,eAAe,CAAC,IAAI,CAAC;MACvB;IACF,CAAC,EACD;MACEyC,IAAI,eAAE/E,KAAA,CAAA8D,aAAA,CAACxD,UAAU;QAAAyD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,EAAG;MACpBE,KAAK,EAAE,OAAO;MACdU,KAAK,EAAE,MAAM;MACbC,OAAO,EAAGlC,CAAC,IAAK;QACdmC,MAAM,CAACC,IAAI,CACR,YAAWpC,CAAC,CAACC,cAAc,CAACC,SAAS,CAACd,SAAU,aAAY,EAC7D,QAAQ,CACT;MACH;IACF,CAAC,CACD;IAAA4B,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,EACF,eAEFpE,KAAA,CAAA8D,aAAA,CAAC5C,YAAY;IACXkE,GAAG,EAAE/C,YAAY,GAAG,kBAAkB,GAAG,mBAAoB;IAC7D8C,IAAI,EAAE9C,YAAa;IACnBgD,OAAO,EAAEA,CAAA,KAAM/C,eAAe,CAAC,KAAK,CAAE;IACtCgD,QAAQ,EAAE/C,aAAc;IAAAwB,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,EACxB,CACE;AAEV,CAAC;AAED,eAAehD,mBAAmB"},"metadata":{},"sourceType":"module"}