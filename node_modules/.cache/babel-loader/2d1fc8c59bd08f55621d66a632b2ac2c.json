{"ast":null,"code":"var _jsxFileName = \"H:\\\\BAKCO\\\\pj\\\\cds\\\\src\\\\medical-test\\\\components\\\\assigns\\\\WaitingToTakeExamTable.js\";\n/* eslint-disable no-nested-ternary */\nimport React, { useState, useEffect } from 'react';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport { FiFileText } from 'react-icons/fi';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getAssignees } from 'medical-test/actions/medical-test';\nimport { useAuth } from 'app/hooks';\nimport { formatToYear } from 'app/utils/helpers';\nimport { getSourceType } from 'infection-chain/utils/helpers';\nimport { DataTable } from 'app/components/shared';\nimport WaitingToTakeExamFilter from './WaitingToTakeExamFilter';\nconst columns = [{\n  Header: '#',\n  accessor: 'index'\n}, {\n  Header: 'Người được xét nghiệm',\n  formatter: row => {\n    var _row$person$name, _row$person;\n    return `${(_row$person$name = (_row$person = row.person) === null || _row$person === void 0 ? void 0 : _row$person.name) !== null && _row$person$name !== void 0 ? _row$person$name : ''} ${row.instanceTime ? moment(row.instanceTime).format('DD-MM-YY HH:mm') : ''}`;\n  },\n  cutlength: 50\n}, {\n  Header: 'Năm sinh',\n  formatter: _ref => {\n    let {\n      person\n    } = _ref;\n    return formatToYear(person === null || person === void 0 ? void 0 : person.dateOfBirth);\n  }\n}, {\n  Header: 'Cơ sở được chỉ định',\n  formatter: _ref2 => {\n    let {\n      unit: {\n        name\n      }\n    } = _ref2;\n    return name;\n  }\n}, {\n  Header: 'Ngày chỉ định',\n  formatter: _ref3 => {\n    let {\n      dateAssigned\n    } = _ref3;\n    return moment(dateAssigned).format('YYYY') !== '0001' ? moment(dateAssigned).format('DD-MM-YYYY') : '';\n  }\n}, {\n  Header: 'Nguồn',\n  formatter: row => {\n    var _getSourceType;\n    return (_getSourceType = getSourceType(row.source)) === null || _getSourceType === void 0 ? void 0 : _getSourceType.label;\n  }\n}];\nconst WaitingToTakeExamTable = () => {\n  const [filter, setFilter] = useState({});\n  const [pageIndex, setPageIndex] = useState(0);\n  const [pageSize, setPageSize] = useState(10);\n  const {\n    assigneeList,\n    getAssigneesLoading\n  } = useSelector(state => state.medicalTest);\n  const {\n    isAdmin\n  } = useAuth();\n  const dispatch = useDispatch();\n  const handleRefresh = () => {\n    if ((!isAdmin && filter.unitId || isAdmin) && !_.isEmpty(filter)) {\n      dispatch(getAssignees({\n        ...filter,\n        isAvailable: false,\n        isOther: undefined,\n        isUnknown: undefined,\n        status: 0,\n        pageIndex,\n        pageSize\n      }));\n    }\n  };\n  useEffect(() => {\n    handleRefresh();\n    // eslint-disable-next-line\n  }, [filter, pageIndex, pageSize]);\n  const {\n    data,\n    pageCount\n  } = assigneeList;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(WaitingToTakeExamFilter, {\n    onChange: setFilter,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(DataTable, {\n    title: \"Danh s\\xE1ch ch\\u1EDD l\\u1EA5y m\\u1EABu\",\n    columns: columns,\n    data: (data || []).map((r, i) => ({\n      ...r,\n      index: i + 1\n    })),\n    loading: getAssigneesLoading,\n    pageCount: pageCount,\n    onPaginationChange: p => {\n      setPageIndex(p.pageIndex);\n      setPageSize(p.pageSize);\n    },\n    actions: [{\n      icon: /*#__PURE__*/React.createElement(FiFileText, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 19\n        }\n      }),\n      title: 'Hồ sơ',\n      color: 'blue',\n      onClick: row => {\n        var _row$person2;\n        window.open(`/profile/${((_row$person2 = row.person) === null || _row$person2 === void 0 ? void 0 : _row$person2.profileId) || row.person.id}/medical-test`, '_blank');\n      }\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }));\n};\nexport default WaitingToTakeExamTable;","map":{"version":3,"names":["React","useState","useEffect","_","moment","FiFileText","useSelector","useDispatch","getAssignees","useAuth","formatToYear","getSourceType","DataTable","WaitingToTakeExamFilter","columns","Header","accessor","formatter","row","_row$person$name","_row$person","person","name","instanceTime","format","cutlength","_ref","dateOfBirth","_ref2","unit","_ref3","dateAssigned","_getSourceType","source","label","WaitingToTakeExamTable","filter","setFilter","pageIndex","setPageIndex","pageSize","setPageSize","assigneeList","getAssigneesLoading","state","medicalTest","isAdmin","dispatch","handleRefresh","unitId","isEmpty","isAvailable","isOther","undefined","isUnknown","status","data","pageCount","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onChange","title","map","r","i","index","loading","onPaginationChange","p","actions","icon","color","onClick","_row$person2","window","open","profileId","id"],"sources":["H:/BAKCO/pj/cds/src/medical-test/components/assigns/WaitingToTakeExamTable.js"],"sourcesContent":["/* eslint-disable no-nested-ternary */\nimport React, { useState, useEffect } from 'react';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport { FiFileText } from 'react-icons/fi';\n\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getAssignees } from 'medical-test/actions/medical-test';\nimport { useAuth } from 'app/hooks';\n\nimport { formatToYear } from 'app/utils/helpers';\nimport { getSourceType } from 'infection-chain/utils/helpers';\n\nimport { DataTable } from 'app/components/shared';\nimport WaitingToTakeExamFilter from './WaitingToTakeExamFilter';\n\nconst columns = [\n  { Header: '#', accessor: 'index' },\n  {\n    Header: 'Người được xét nghiệm',\n    formatter: (row) =>\n      `${row.person?.name ?? ''} ${\n        row.instanceTime\n          ? moment(row.instanceTime).format('DD-MM-YY HH:mm')\n          : ''\n      }`,\n    cutlength: 50,\n  },\n  {\n    Header: 'Năm sinh',\n    formatter: ({ person }) => formatToYear(person?.dateOfBirth),\n  },\n  { Header: 'Cơ sở được chỉ định', formatter: ({ unit: { name } }) => name },\n  {\n    Header: 'Ngày chỉ định',\n    formatter: ({ dateAssigned }) =>\n      moment(dateAssigned).format('YYYY') !== '0001'\n        ? moment(dateAssigned).format('DD-MM-YYYY')\n        : '',\n  },\n  { Header: 'Nguồn', formatter: (row) => getSourceType(row.source)?.label },\n];\n\nconst WaitingToTakeExamTable = () => {\n  const [filter, setFilter] = useState({});\n  const [pageIndex, setPageIndex] = useState(0);\n  const [pageSize, setPageSize] = useState(10);\n\n  const { assigneeList, getAssigneesLoading } = useSelector(\n    (state) => state.medicalTest,\n  );\n\n  const { isAdmin } = useAuth();\n\n  const dispatch = useDispatch();\n\n  const handleRefresh = () => {\n    if (((!isAdmin && filter.unitId) || isAdmin) && !_.isEmpty(filter)) {\n      dispatch(\n        getAssignees({\n          ...filter,\n          isAvailable: false,\n          isOther: undefined,\n          isUnknown: undefined,\n          status: 0,\n          pageIndex,\n          pageSize,\n        }),\n      );\n    }\n  };\n\n  useEffect(() => {\n    handleRefresh();\n    // eslint-disable-next-line\n  }, [filter, pageIndex, pageSize]);\n\n  const { data, pageCount } = assigneeList;\n\n  return (\n    <div>\n      <WaitingToTakeExamFilter onChange={setFilter} />\n      <DataTable\n        title=\"Danh sách chờ lấy mẫu\"\n        columns={columns}\n        data={(data || []).map((r, i) => ({ ...r, index: i + 1 }))}\n        loading={getAssigneesLoading}\n        pageCount={pageCount}\n        onPaginationChange={(p) => {\n          setPageIndex(p.pageIndex);\n          setPageSize(p.pageSize);\n        }}\n        actions={[\n          {\n            icon: <FiFileText />,\n            title: 'Hồ sơ',\n            color: 'blue',\n            onClick: (row) => {\n              window.open(\n                `/profile/${\n                  row.person?.profileId || row.person.id\n                }/medical-test`,\n                '_blank',\n              );\n            },\n          },\n        ]}\n      />\n    </div>\n  );\n};\n\nexport default WaitingToTakeExamTable;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}