{"ast":null,"code":"var _jsxFileName = \"H:\\\\BAKCO\\\\pj\\\\data reconciliation\\\\src\\\\quarantine-facilities\\\\components\\\\quarantine-in-facility\\\\CreateProfileFromQuarantineModal.js\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Controller, useForm } from 'react-hook-form';\nimport { Form, Header, Modal } from 'semantic-ui-react';\nimport moment from 'moment';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createAppoint } from 'quarantine-facilities/actions/quarantine';\nimport { useAuth } from 'app/hooks';\nimport SubjectForm from 'infection-chain/components/subject/information/SubjectForm';\nimport { formatObjectToAddress } from 'app/utils/helpers';\nimport { KeyboardDatePicker } from 'app/components/shared';\nconst CreateProfileFromQuarantineModal = props => {\n  var _facilityInfo$0$id, _facilityInfo$;\n  const {\n    open,\n    onClose,\n    onSubmit\n  } = props;\n  const {\n    watch,\n    control,\n    setValue,\n    getValues\n  } = useForm();\n  const dispatch = useDispatch();\n  const {\n    isAdmin\n  } = useAuth();\n  const {\n    getFacilitiesLoading,\n    facilityData: {\n      data\n    },\n    facilityInfo\n  } = useSelector(s => s.quarantineFacility);\n  const quarantineFacilityId = (_facilityInfo$0$id = (_facilityInfo$ = facilityInfo[0]) === null || _facilityInfo$ === void 0 ? void 0 : _facilityInfo$.id) !== null && _facilityInfo$0$id !== void 0 ? _facilityInfo$0$id : '';\n  const {\n    createAppointLoading\n  } = useSelector(s => s.quarantine);\n  const handleCreateProfile = async profile => {\n    var _d$quarantineFacility;\n    const d = getValues();\n    const {\n      dateOfBirth,\n      homeAddress: quarantineHomeAddress\n    } = profile;\n    let formattedDOB = '';\n    if ((dateOfBirth === null || dateOfBirth === void 0 ? void 0 : dateOfBirth.length) === 4) {\n      formattedDOB = moment(dateOfBirth, 'YYYY').startOf('year').format('YYYY-MM-DD');\n    }\n    await dispatch(createAppoint({\n      profile: {\n        ...profile,\n        dateOfBirth: formattedDOB || dateOfBirth\n      },\n      ...d,\n      quarantineFacilityId: (_d$quarantineFacility = d === null || d === void 0 ? void 0 : d.quarantineFacilityId) !== null && _d$quarantineFacility !== void 0 ? _d$quarantineFacility : quarantineFacilityId,\n      quarantineHomeAddress\n    }));\n    onClose();\n    onSubmit();\n  };\n  const quarantineFacility = watch('quarantineFacilityId');\n  const startQuarantineTime = watch('startQuarantineTime');\n  return /*#__PURE__*/React.createElement(Modal, {\n    open: open,\n    onClose: onClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }, \"T\\u1EA1o \\u0111\\u1ED1i t\\u01B0\\u1EE3ng c\\xE1ch ly\"), /*#__PURE__*/React.createElement(Modal.Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ui form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  }, (isAdmin || !quarantineFacilityId) && /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Controller, {\n    name: \"quarantineFacilityId\",\n    defaultValue: \"\",\n    control: control,\n    render: () => /*#__PURE__*/React.createElement(Form.Select, {\n      fluid: true,\n      required: true,\n      search: true,\n      deburr: true,\n      clearable: true,\n      label: \"Khu c\\xE1ch ly ch\\u1EC9 \\u0111\\u1ECBnh\",\n      loading: getFacilitiesLoading,\n      onChange: (e, _ref) => {\n        let {\n          value\n        } = _ref;\n        return setValue('quarantineFacilityId', value);\n      },\n      options: (data || []).map(d => ({\n        value: d.id,\n        text: d.name,\n        content: /*#__PURE__*/React.createElement(Header, {\n          content: d.name,\n          subheader: `Địa chỉ: ${formatObjectToAddress(d)}`,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }\n        })\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 19\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Controller, {\n    name: \"startQuarantineTime\",\n    defaultValue: \"\",\n    control: control,\n    render: _ref2 => {\n      let {\n        onChange\n      } = _ref2;\n      return /*#__PURE__*/React.createElement(Form.Field, {\n        fluid: true,\n        required: true,\n        control: KeyboardDatePicker,\n        label: \"Ng\\xE0y ch\\u1EC9 \\u0111\\u1ECBnh\",\n        onChange: onChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 19\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    fluid: true,\n    required: true,\n    disableSubmit: Boolean((isAdmin || !quarantineFacilityId) && !quarantineFacility || !startQuarantineTime),\n    control: SubjectForm,\n    loading: createAppointLoading,\n    onSubmit: handleCreateProfile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }\n  })))));\n};\nCreateProfileFromQuarantineModal.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onSubmit: PropTypes.func.isRequired\n};\nexport default CreateProfileFromQuarantineModal;","map":{"version":3,"names":["React","PropTypes","Controller","useForm","Form","Header","Modal","moment","useDispatch","useSelector","createAppoint","useAuth","SubjectForm","formatObjectToAddress","KeyboardDatePicker","CreateProfileFromQuarantineModal","props","_facilityInfo$0$id","_facilityInfo$","open","onClose","onSubmit","watch","control","setValue","getValues","dispatch","isAdmin","getFacilitiesLoading","facilityData","data","facilityInfo","s","quarantineFacility","quarantineFacilityId","id","createAppointLoading","quarantine","handleCreateProfile","profile","_d$quarantineFacility","d","dateOfBirth","homeAddress","quarantineHomeAddress","formattedDOB","length","startOf","format","startQuarantineTime","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Content","className","Group","widths","name","defaultValue","render","Select","fluid","required","search","deburr","clearable","label","loading","onChange","e","_ref","value","options","map","text","content","subheader","_ref2","Field","disableSubmit","Boolean","propTypes","bool","isRequired","func"],"sources":["H:/BAKCO/pj/data reconciliation/src/quarantine-facilities/components/quarantine-in-facility/CreateProfileFromQuarantineModal.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Controller, useForm } from 'react-hook-form';\n\nimport { Form, Header, Modal } from 'semantic-ui-react';\nimport moment from 'moment';\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createAppoint } from 'quarantine-facilities/actions/quarantine';\nimport { useAuth } from 'app/hooks';\n\nimport SubjectForm from 'infection-chain/components/subject/information/SubjectForm';\nimport { formatObjectToAddress } from 'app/utils/helpers';\nimport { KeyboardDatePicker } from 'app/components/shared';\n\nconst CreateProfileFromQuarantineModal = (props) => {\n  const { open, onClose, onSubmit } = props;\n  const { watch, control, setValue, getValues } = useForm();\n  const dispatch = useDispatch();\n\n  const { isAdmin } = useAuth();\n  const {\n    getFacilitiesLoading,\n    facilityData: { data },\n    facilityInfo,\n  } = useSelector((s) => s.quarantineFacility);\n  const quarantineFacilityId = facilityInfo[0]?.id ?? '';\n\n  const { createAppointLoading } = useSelector((s) => s.quarantine);\n\n  const handleCreateProfile = async (profile) => {\n    const d = getValues();\n    const { dateOfBirth, homeAddress: quarantineHomeAddress } = profile;\n    let formattedDOB = '';\n    if (dateOfBirth?.length === 4) {\n      formattedDOB = moment(dateOfBirth, 'YYYY')\n        .startOf('year')\n        .format('YYYY-MM-DD');\n    }\n    await dispatch(\n      createAppoint({\n        profile: {\n          ...profile,\n          dateOfBirth: formattedDOB || dateOfBirth,\n        },\n        ...d,\n        quarantineFacilityId: d?.quarantineFacilityId ?? quarantineFacilityId,\n        quarantineHomeAddress,\n      }),\n    );\n    onClose();\n    onSubmit();\n  };\n  const quarantineFacility = watch('quarantineFacilityId');\n  const startQuarantineTime = watch('startQuarantineTime');\n  return (\n    <Modal open={open} onClose={onClose}>\n      <Modal.Header>Tạo đối tượng cách ly</Modal.Header>\n      <Modal.Content>\n        <div className=\"ui form\">\n          {(isAdmin || !quarantineFacilityId) && (\n            <Form.Group widths=\"equal\">\n              <Controller\n                name=\"quarantineFacilityId\"\n                defaultValue=\"\"\n                control={control}\n                render={() => (\n                  <Form.Select\n                    fluid\n                    required\n                    search\n                    deburr\n                    clearable\n                    label=\"Khu cách ly chỉ định\"\n                    loading={getFacilitiesLoading}\n                    onChange={(e, { value }) =>\n                      setValue('quarantineFacilityId', value)\n                    }\n                    options={(data || []).map((d) => ({\n                      value: d.id,\n                      text: d.name,\n                      content: (\n                        <Header\n                          content={d.name}\n                          subheader={`Địa chỉ: ${formatObjectToAddress(d)}`}\n                        />\n                      ),\n                    }))}\n                  />\n                )}\n              />\n              <Controller\n                name=\"startQuarantineTime\"\n                defaultValue=\"\"\n                control={control}\n                render={({ onChange }) => (\n                  <Form.Field\n                    fluid\n                    required\n                    control={KeyboardDatePicker}\n                    label=\"Ngày chỉ định\"\n                    onChange={onChange}\n                  />\n                )}\n              />\n            </Form.Group>\n          )}\n          <Form.Group widths=\"equal\">\n            <Form.Field\n              fluid\n              required\n              disableSubmit={Boolean(\n                ((isAdmin || !quarantineFacilityId) && !quarantineFacility) ||\n                  !startQuarantineTime,\n              )}\n              control={SubjectForm}\n              loading={createAppointLoading}\n              onSubmit={handleCreateProfile}\n            />\n          </Form.Group>\n        </div>\n      </Modal.Content>\n    </Modal>\n  );\n};\n\nCreateProfileFromQuarantineModal.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onSubmit: PropTypes.func.isRequired,\n};\n\nexport default CreateProfileFromQuarantineModal;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}