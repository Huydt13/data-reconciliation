{"ast":null,"code":"var _jsxFileName = \"H:\\\\BAKCO\\\\pj\\\\data reconciliation\\\\src\\\\quarantine-facilities\\\\components\\\\quarantine-in-facility\\\\FacilityFormTable.js\";\n/* eslint-disable no-nested-ternary */\nimport React, { useEffect, useCallback, useState } from 'react';\nimport moment from 'moment';\nimport { FiPlus, FiFileText, FiCheck } from 'react-icons/fi';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createQuarantineForm, getQuarantineForms } from 'quarantine-facilities/actions/quarantine-form';\nimport { DataTable } from 'app/components/shared';\nimport { showConfirmModal } from 'app/actions/global';\nimport { checkFilter } from 'app/utils/helpers';\nimport FacilityFormFilter from './FacilityFormFilter';\nimport CreateFacilityFormModal from './CreateFacilityFormModal';\nimport FacilityFormDetailModal from './FacilityFormDetailModal';\nconst columns = [{\n  Header: '#',\n  accessor: 'index'\n}, {\n  Header: 'Tên',\n  formatter: r => r.fullName\n}, {\n  Header: 'Ngày đăng ký',\n  formatter: r => moment(r.dateCreated).format('DD-MM-YY HH:mm')\n}, {\n  Header: 'Đã duyệt',\n  formatter: r => r.finalApproval ? /*#__PURE__*/React.createElement(FiCheck, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 42\n    }\n  }) : null\n}];\nconst FacilityFormTable = () => {\n  const {\n    quarantineFormData,\n    getQuarantineFormLoading,\n    createQuarantineFormLoading,\n    updateQuarantineFormLoading,\n    deleteQuarantineFormLoading\n  } = useSelector(s => s.quarantineForm);\n  const loading = getQuarantineFormLoading || createQuarantineFormLoading || updateQuarantineFormLoading || deleteQuarantineFormLoading;\n  const {\n    totalPages,\n    data\n  } = quarantineFormData;\n  const dispatch = useDispatch();\n  const [filter, setFilter] = useState({});\n  const [pageSize, setPageSize] = useState(10);\n  const [pageIndex, setPageIndex] = useState(0);\n  const getData = useCallback(() => {\n    dispatch(getQuarantineForms({\n      ...filter,\n      pageIndex,\n      pageSize\n    }));\n  }, [dispatch, filter, pageIndex, pageSize]);\n  useEffect(getData, [getData]);\n  const [selectingId, setSelectingId] = useState('');\n  const [createModal, setCreateModal] = useState(false);\n  const [detailModal, setDetailModal] = useState(false);\n  const handleCreate = d => {\n    const {\n      requester,\n      requester: {\n        dateOfBirth\n      }\n    } = d;\n    let formattedDOB = '';\n    if (dateOfBirth.length === 4) {\n      formattedDOB = moment(dateOfBirth, 'YYYY').startOf('year').format('YYYY-MM-DD');\n    }\n    dispatch(createQuarantineForm({\n      ...d,\n      requester: {\n        ...requester,\n        dateOfBirth: formattedDOB || dateOfBirth\n      }\n    })).then(() => {\n      setCreateModal(false);\n      getData();\n    });\n  };\n  const handleApprove = () => {\n    dispatch(showConfirmModal('Chấp nhận đăng ký này?', () => {\n      setSelectingId('');\n      setDetailModal(false);\n      getData();\n    }));\n  };\n  const handleDecline = () => {\n    dispatch(showConfirmModal('Từ chối đăng ký này?', () => {\n      setSelectingId('');\n      setDetailModal(false);\n      getData();\n    }));\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FacilityFormFilter, {\n    onChange: d => checkFilter(filter, d) && setFilter(d),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(DataTable, {\n    title: \"Danh s\\xE1ch \\u0111\\u0103ng k\\xFD c\\xE1ch ly\",\n    loading: loading,\n    columns: columns,\n    pageCount: totalPages,\n    onPaginationChange: p => {\n      setPageSize(p.pageSize);\n      setPageIndex(p.pageIndex);\n    },\n    data: (data || []).map((d, i) => ({\n      ...d,\n      index: i + 1\n    })),\n    actions: [{\n      icon: /*#__PURE__*/React.createElement(FiPlus, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 19\n        }\n      }),\n      title: 'Thêm',\n      color: 'green',\n      globalAction: true,\n      onClick: () => {\n        setSelectingId('');\n        setCreateModal(true);\n      }\n    }, {\n      icon: /*#__PURE__*/React.createElement(FiFileText, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 19\n        }\n      }),\n      title: 'Chi tiết',\n      color: 'blue',\n      onClick: r => {\n        setSelectingId(r.id);\n        setDetailModal(true);\n      }\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(CreateFacilityFormModal, {\n    open: createModal,\n    onClose: () => setCreateModal(false),\n    onSubmit: handleCreate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(FacilityFormDetailModal, {\n    open: detailModal,\n    onClose: () => setDetailModal(false),\n    requestId: selectingId,\n    onApprove: handleApprove,\n    onDecline: handleDecline,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }\n  }));\n};\nexport default FacilityFormTable;","map":{"version":3,"names":["React","useEffect","useCallback","useState","moment","FiPlus","FiFileText","FiCheck","useDispatch","useSelector","createQuarantineForm","getQuarantineForms","DataTable","showConfirmModal","checkFilter","FacilityFormFilter","CreateFacilityFormModal","FacilityFormDetailModal","columns","Header","accessor","formatter","r","fullName","dateCreated","format","finalApproval","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","FacilityFormTable","quarantineFormData","getQuarantineFormLoading","createQuarantineFormLoading","updateQuarantineFormLoading","deleteQuarantineFormLoading","s","quarantineForm","loading","totalPages","data","dispatch","filter","setFilter","pageSize","setPageSize","pageIndex","setPageIndex","getData","selectingId","setSelectingId","createModal","setCreateModal","detailModal","setDetailModal","handleCreate","d","requester","dateOfBirth","formattedDOB","length","startOf","then","handleApprove","handleDecline","Fragment","onChange","title","pageCount","onPaginationChange","p","map","i","index","actions","icon","color","globalAction","onClick","id","open","onClose","onSubmit","requestId","onApprove","onDecline"],"sources":["H:/BAKCO/pj/data reconciliation/src/quarantine-facilities/components/quarantine-in-facility/FacilityFormTable.js"],"sourcesContent":["/* eslint-disable no-nested-ternary */\nimport React, { useEffect, useCallback, useState } from 'react';\nimport moment from 'moment';\n\nimport { FiPlus, FiFileText, FiCheck } from 'react-icons/fi';\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  createQuarantineForm,\n  getQuarantineForms,\n} from 'quarantine-facilities/actions/quarantine-form';\n\nimport { DataTable } from 'app/components/shared';\nimport { showConfirmModal } from 'app/actions/global';\n\nimport { checkFilter } from 'app/utils/helpers';\n\nimport FacilityFormFilter from './FacilityFormFilter';\nimport CreateFacilityFormModal from './CreateFacilityFormModal';\nimport FacilityFormDetailModal from './FacilityFormDetailModal';\n\nconst columns = [\n  { Header: '#', accessor: 'index' },\n  { Header: 'Tên', formatter: (r) => r.fullName },\n  {\n    Header: 'Ngày đăng ký',\n    formatter: (r) => moment(r.dateCreated).format('DD-MM-YY HH:mm'),\n  },\n  {\n    Header: 'Đã duyệt',\n    formatter: (r) => (r.finalApproval ? <FiCheck /> : null),\n  },\n];\nconst FacilityFormTable = () => {\n  const {\n    quarantineFormData,\n    getQuarantineFormLoading,\n    createQuarantineFormLoading,\n    updateQuarantineFormLoading,\n    deleteQuarantineFormLoading,\n  } = useSelector((s) => s.quarantineForm);\n  const loading =\n    getQuarantineFormLoading ||\n    createQuarantineFormLoading ||\n    updateQuarantineFormLoading ||\n    deleteQuarantineFormLoading;\n  const { totalPages, data } = quarantineFormData;\n\n  const dispatch = useDispatch();\n  const [filter, setFilter] = useState({});\n  const [pageSize, setPageSize] = useState(10);\n  const [pageIndex, setPageIndex] = useState(0);\n  const getData = useCallback(() => {\n    dispatch(\n      getQuarantineForms({\n        ...filter,\n        pageIndex,\n        pageSize,\n      }),\n    );\n  }, [dispatch, filter, pageIndex, pageSize]);\n  useEffect(getData, [getData]);\n\n  const [selectingId, setSelectingId] = useState('');\n  const [createModal, setCreateModal] = useState(false);\n  const [detailModal, setDetailModal] = useState(false);\n  const handleCreate = (d) => {\n    const {\n      requester,\n      requester: { dateOfBirth },\n    } = d;\n    let formattedDOB = '';\n    if (dateOfBirth.length === 4) {\n      formattedDOB = moment(dateOfBirth, 'YYYY')\n        .startOf('year')\n        .format('YYYY-MM-DD');\n    }\n    dispatch(\n      createQuarantineForm({\n        ...d,\n        requester: {\n          ...requester,\n          dateOfBirth: formattedDOB || dateOfBirth,\n        },\n      }),\n    ).then(() => {\n      setCreateModal(false);\n      getData();\n    });\n  };\n  const handleApprove = () => {\n    dispatch(\n      showConfirmModal('Chấp nhận đăng ký này?', () => {\n        setSelectingId('');\n        setDetailModal(false);\n        getData();\n      }),\n    );\n  };\n  const handleDecline = () => {\n    dispatch(\n      showConfirmModal('Từ chối đăng ký này?', () => {\n        setSelectingId('');\n        setDetailModal(false);\n        getData();\n      }),\n    );\n  };\n\n  return (\n    <>\n      <FacilityFormFilter\n        onChange={(d) => checkFilter(filter, d) && setFilter(d)}\n      />\n      <DataTable\n        title=\"Danh sách đăng ký cách ly\"\n        loading={loading}\n        columns={columns}\n        pageCount={totalPages}\n        onPaginationChange={(p) => {\n          setPageSize(p.pageSize);\n          setPageIndex(p.pageIndex);\n        }}\n        data={(data || []).map((d, i) => ({ ...d, index: i + 1 }))}\n        actions={[\n          {\n            icon: <FiPlus />,\n            title: 'Thêm',\n            color: 'green',\n            globalAction: true,\n            onClick: () => {\n              setSelectingId('');\n              setCreateModal(true);\n            },\n          },\n          {\n            icon: <FiFileText />,\n            title: 'Chi tiết',\n            color: 'blue',\n            onClick: (r) => {\n              setSelectingId(r.id);\n              setDetailModal(true);\n            },\n          },\n        ]}\n      />\n      <CreateFacilityFormModal\n        open={createModal}\n        onClose={() => setCreateModal(false)}\n        onSubmit={handleCreate}\n      />\n      <FacilityFormDetailModal\n        open={detailModal}\n        onClose={() => setDetailModal(false)}\n        requestId={selectingId}\n        onApprove={handleApprove}\n        onDecline={handleDecline}\n      />\n    </>\n  );\n};\n\nexport default FacilityFormTable;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}